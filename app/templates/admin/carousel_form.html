{% extends "layouts/base.html" %}
{% block title %}{{ 'Create' if mode=='create' else 'Edit' }} Carousel — {{ settings.APP_NAME }}{% endblock %}
{% block content %}
<section class="py-4">
  <div class="container">
    <h1 class="h5 mb-3">{{ 'Create' if mode=='create' else 'Edit' }} Carousel Item</h1>
    <form method="post" enctype="multipart/form-data">
      <div class="row g-3">
        <div class="col-md-3">
          <label class="form-label">Media Type</label>
          <select name="media_type" class="form-select">
            {% set mt = (item.media_type if item else 'image') %}
            <option value="image" {{ 'selected' if mt=='image' else '' }}>Image</option>
            <option value="video" {{ 'selected' if mt=='video' else '' }}>Video</option>
          </select>
        </div>
        <div class="col-md-3">
          <label class="form-label">Sort Order</label>
          <input type="number" name="sort_order" class="form-control" value="{{ item.sort_order if item else 0 }}">
        </div>
        <div class="col-md-3 d-flex align-items-end">
          <div class="form-check">
            {% set act = (item.is_active if item else True) %}
            <input class="form-check-input" type="checkbox" name="is_active" id="is_active" {{ 'checked' if act else '' }}>
            <label class="form-check-label" for="is_active">Active</label>
          </div>
        </div>
      </div>

      <div class="row g-3 mt-1">
        <div class="col-md-6">
          <label class="form-label">Media File (image/video)</label>
          <input type="file" name="media_file" class="form-control" accept="image/*,video/*">
          {% if item and item.media_path %}
            <small class="text-muted d-block mt-1">Current: {{ item.media_path }}</small>
          {% endif %}
        </div>
        <div class="col-md-6">
          <label class="form-label">Poster (video only)</label>
          <input type="file" name="poster_file" class="form-control" accept="image/*">
          {% if item and item.poster_path %}
            <small class="text-muted d-block mt-1">Current: {{ item.poster_path }}</small>
          {% endif %}
        </div>
      </div>

      <hr class="my-4">

      <ul class="nav nav-tabs" role="tablist">
        <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#tab-id" role="tab">Bahasa (ID)</a></li>
        <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-en" role="tab">English (EN)</a></li>
        <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-ar" role="tab">العربية (AR)</a></li>
      </ul>
      <div class="tab-content border border-top-0 p-3 rounded-bottom">
  {% set tr_id = (trs['id'] if trs and 'id' in trs else None) %}
  {% set tr_en = (trs['en'] if trs and 'en' in trs else None) %}
  {% set tr_ar = (trs['ar'] if trs and 'ar' in trs else None) %}

  {% for code,tr,label in [('id',tr_id,'ID'),('en',tr_en,'EN'),('ar',tr_ar,'AR')] %}
  <div class="tab-pane fade {{ 'show active' if loop.index==1 else '' }}" id="tab-{{code}}" role="tabpanel" {% if code=='ar' %}dir="rtl"{% endif %}>
    <div class="mb-2">
      <label class="form-label">Title ({{label}})</label>
      <input name="{{code}}_title" class="form-control" value="{{ tr.title if tr else '' }}">
    </div>
    <div class="mb-2">
      <label class="form-label">Subtitle ({{label}})</label>
      <textarea name="{{code}}_subtitle" class="form-control" rows="2">{{ tr.subtitle if tr else '' }}</textarea>
    </div>
    <div class="row">
      <div class="col-md-6 mb-2">
        <label class="form-label">CTA Text ({{label}})</label>
        <input name="{{code}}_cta_text" class="form-control" value="{{ tr.cta_text if tr else '' }}">
      </div>
      <div class="col-md-6 mb-2">
        <label class="form-label">CTA URL ({{label}})</label>
        <input name="{{code}}_cta_url" class="form-control" value="{{ tr.cta_url if tr else '' }}" placeholder="/portfolio">
      </div>
    </div>
  </div>
  {% endfor %}
</div>

      <div class="mt-3 d-flex gap-2">
        <button class="btn btn-primary">{{ 'Create' if mode=='create' else 'Save Changes' }}</button>
        <a class="btn btn-outline-secondary" href="/admin/carousel">Cancel</a>
      </div>
    </form>
  </div>
</section>
{% endblock %}