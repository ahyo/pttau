{% set lang = (request.state.lang if request and request.state and request.state.lang else settings.DEFAULT_LANG) %}
{% set i18n = (request.state.i18n if request and request.state and request.state.i18n else None) %}
{% set admin = (request.state.admin if request and request.state else None) %}
{% set header_menu = (request.state.header_menu if request and request.state else []) %}
{% set footer_sections = (request.state.footer_data if request and request.state else []) %}
<!doctype html>
<html lang="{{ lang }}" {% if lang=='ar' %}dir="rtl"{% endif %}>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}{{ i18n.t('nav_portfolio') }} â€” {{ i18n.t('nav_about') }}{% endblock %}</title>
    <meta name="description" content="{% block meta_desc %}{% endblock %}">
    <meta property="og:title" content="{% block og_title %}{% endblock %}">
    <meta property="og:description" content="{% block og_desc %}{% endblock %}">
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', path='/img/favicon.ico') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/style.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css">
    <!-- Trumbowyg CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/trumbowyg@2.28.0/dist/ui/trumbowyg.min.css">
    {% if lang=='ar' %}<link href="/static/css/rtl.css" rel="stylesheet">{% endif %}
  </head>
  <body class="d-flex flex-column min-vh-100">
    {% include 'partials/navbar.html' %}
    <main class="flex-shrink-0">
      {% block content %}{% endblock %}
    </main>
    {% include 'partials/footer.html' %}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
    <script>
      AOS.init({
        duration: 700,      // durasi animasi (ms)
        easing: 'ease-out', // kurva animasi
        offset: 80,         // jarak trigger dari viewport
        once: true,         // animasi hanya sekali
        mirror: false       // jangan animasi saat scroll ke atas
      });
    </script>
    <!-- jQuery (dibutuhkan oleh Trumbowyg) -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<!-- Trumbowyg JS -->
<script src="https://cdn.jsdelivr.net/npm/trumbowyg@2.28.0/dist/trumbowyg.min.js"></script>

<!-- Optional: plugin upload/image kalau mau -->
<script src="https://cdn.jsdelivr.net/npm/trumbowyg@2.28.0/dist/plugins/upload/trumbowyg.upload.min.js"></script>

<script>
  $(document).ready(function () {
    // Inisialisasi editor di semua textarea konten panjang
    $('textarea[name$="_body"],textarea[name="id_subtitle"],textarea[name="en_subtitle"],textarea[name="ar_subtitle"], textarea[name="description"]').trumbowyg({
      btns: [
        ['viewHTML'],
        ['undo', 'redo'],
        ['formatting'],
        ['strong', 'em', 'del'],
        ['superscript', 'subscript'],
        ['link'],
        ['insertImage'],
        ['unorderedList', 'orderedList'],
        ['horizontalRule'],
        ['removeformat'],
        ['fullscreen']
      ],
      autogrow: true,
      minimalLinks: true,
      removeformatPasted: true
    });
  });
</script>
  </body>
</html>
